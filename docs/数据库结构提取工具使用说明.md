# CoreBank æ•°æ®åº“ç»“æ„æå–å·¥å…·ä½¿ç”¨è¯´æ˜

## ğŸ“‹ å·¥å…·æ¦‚è¿°

æˆ‘ä¸ºæ‚¨åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åº“ç»“æ„æå–å·¥å…·ï¼Œå¯ä»¥å…¨é¢åˆ†æCoreBankæ•°æ®åº“çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨ã€åˆ—ã€ç´¢å¼•ã€çº¦æŸã€å¤–é”®å…³ç³»ç­‰ã€‚

## ğŸ› ï¸ å¯ç”¨å·¥å…·

### 1. å®Œæ•´ç‰ˆåˆ†æå·¥å…· - `complete_database_analyzer.py`
**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- è¯¦ç»†çš„è¡¨ç»“æ„åˆ†æï¼ˆåˆ—ã€çº¦æŸã€ç´¢å¼•ã€å¤–é”®ï¼‰
- å®Œæ•´çš„å¤–é”®å…³ç³»æ˜ å°„
- æ•°æ®ç»Ÿè®¡ä¿¡æ¯
- JSONå’ŒMarkdownåŒæ ¼å¼è¾“å‡º
- ç»“æ„åŒ–æ•°æ®å­˜å‚¨

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python complete_database_analyzer.py
```

### 2. ç®€åŒ–ç‰ˆåˆ†æå·¥å…· - `simple_complete_analyzer.py` â­ **æ¨è**
**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨PostgreSQLåŸç”Ÿå‘½ä»¤æå–ç»“æ„
- å®Œæ•´çš„è¡¨ç»“æ„è¯¦æƒ…ï¼ˆåŒ…å«ç´¢å¼•ã€çº¦æŸã€è§¦å‘å™¨ï¼‰
- æ¸…æ™°çš„å¤–é”®å…³ç³»
- æ•°æ®ç»Ÿè®¡å’Œè¡Œæ•°ç»Ÿè®¡
- æ›´ç¨³å®šçš„æ•°æ®æå–

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python simple_complete_analyzer.py
```

### 3. åŸºç¡€åˆ†æå·¥å…· - `simple_db_analyzer.py`
**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- å•è¡¨ç»“æ„æŸ¥çœ‹
- å¿«é€Ÿç»“æ„æ£€æŸ¥

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python simple_db_analyzer.py <table_name>
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### JSONç»“æ„æ–‡ä»¶
**æ–‡ä»¶åæ ¼å¼**ï¼š`complete_database_structure_YYYYMMDD_HHMMSS.json`

**åŒ…å«å†…å®¹**ï¼š
- æ•°æ®åº“åŸºæœ¬ä¿¡æ¯ï¼ˆç‰ˆæœ¬ã€å¤§å°ã€è¡¨æ•°é‡ï¼‰
- æ¯ä¸ªè¡¨çš„å®Œæ•´ç»“æ„ä¿¡æ¯
- å¤–é”®å…³ç³»åˆ—è¡¨
- æ•°æ®ç»Ÿè®¡ä¿¡æ¯

### MarkdownæŠ¥å‘Šæ–‡ä»¶
**æ–‡ä»¶åæ ¼å¼**ï¼š`complete_database_report_YYYYMMDD_HHMMSS.md`

**åŒ…å«å†…å®¹**ï¼š
- æ•°æ®åº“æ¦‚è§ˆ
- æ•°æ®ç»Ÿè®¡è¡¨æ ¼
- å¤–é”®å…³ç³»å›¾
- æ¯ä¸ªè¡¨çš„è¯¦ç»†ç»“æ„ï¼ˆåŒ…å«SQL DDLï¼‰

## ğŸ” æœ€æ–°åˆ†æç»“æœ

### æ•°æ®åº“æ¦‚è§ˆ
- **æ•°æ®åº“å**: corebank
- **ç‰ˆæœ¬**: PostgreSQL 16.8
- **æ€»è¡¨æ•°**: 11
- **æ€»è¡Œæ•°**: 267
- **å¤–é”®å…³ç³»**: 13ä¸ª

### è¡¨ç»Ÿè®¡
| è¡¨å | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| accounts | 16 | é“¶è¡Œè´¦æˆ· |
| alembic_version | 2 | æ•°æ®åº“ç‰ˆæœ¬ç®¡ç† |
| investment_holdings | 8 | æŠ•èµ„æŒä»“ |
| investment_products | 6 | æŠ•èµ„äº§å“ |
| investment_transactions | 15 | æŠ•èµ„äº¤æ˜“ |
| product_nav_history | 93 | äº§å“å‡€å€¼å†å² |
| transaction_entries | 68 | äº¤æ˜“æ¡ç›®ï¼ˆåŒè®°è´¦ï¼‰ |
| transaction_groups | 34 | äº¤æ˜“ç»„ï¼ˆåŒè®°è´¦ï¼‰ |
| user_profiles | 6 | ç”¨æˆ·ä¸ªäººä¿¡æ¯ |
| user_risk_assessments | 4 | é£é™©è¯„ä¼° |
| users | 15 | ç”¨æˆ·åŸºç¡€ä¿¡æ¯ |

### å¤–é”®å…³ç³»
```
users (1) â”€â”€â†’ (N) accounts
users (1) â”€â”€â†’ (1) user_profiles  
users (1) â”€â”€â†’ (N) user_risk_assessments
users (1) â”€â”€â†’ (N) investment_holdings
users (1) â”€â”€â†’ (N) investment_transactions

accounts (1) â”€â”€â†’ (N) transaction_entries
accounts (1) â”€â”€â†’ (N) investment_holdings
accounts (1) â”€â”€â†’ (N) investment_transactions

transaction_groups (1) â”€â”€â†’ (N) transaction_entries

investment_products (1) â”€â”€â†’ (N) investment_holdings
investment_products (1) â”€â”€â†’ (N) investment_transactions
investment_products (1) â”€â”€â†’ (N) product_nav_history

investment_holdings (1) â”€â”€â†’ (N) investment_transactions
```

## ğŸš€ ä½¿ç”¨å»ºè®®

### 1. æ—¥å¸¸ç»“æ„æ£€æŸ¥
```bash
# å¿«é€ŸæŸ¥çœ‹å•ä¸ªè¡¨ç»“æ„
python simple_db_analyzer.py users

# æŸ¥çœ‹è´¦æˆ·è¡¨ç»“æ„
python simple_db_analyzer.py accounts
```

### 2. å®Œæ•´ç»“æ„åˆ†æ
```bash
# ç”Ÿæˆå®Œæ•´çš„æ•°æ®åº“ç»“æ„æŠ¥å‘Š
python simple_complete_analyzer.py
```

### 3. ç»“æ„å˜æ›´è¿½è¸ª
- åœ¨æ•°æ®åº“ç»“æ„å˜æ›´å‰åè¿è¡Œåˆ†æå·¥å…·
- æ¯”è¾ƒç”Ÿæˆçš„JSONæ–‡ä»¶å·®å¼‚
- ç”¨äºç‰ˆæœ¬æ§åˆ¶å’Œå˜æ›´ç®¡ç†

## ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶

### æœ€æ–°ç”Ÿæˆçš„æ–‡ä»¶
- `complete_database_structure_20250626_155736.json` - å®Œæ•´JSONç»“æ„
- `complete_database_report_20250626_155736.md` - è¯¦ç»†MarkdownæŠ¥å‘Š

### æ–‡ä»¶ç”¨é€”
1. **JSONæ–‡ä»¶**ï¼š
   - ç¨‹åºåŒ–å¤„ç†æ•°æ®åº“ç»“æ„
   - ç»“æ„æ¯”è¾ƒå’Œå·®å¼‚åˆ†æ
   - è‡ªåŠ¨åŒ–å·¥å…·é›†æˆ

2. **Markdownæ–‡ä»¶**ï¼š
   - äººç±»å¯è¯»çš„ç»“æ„æ–‡æ¡£
   - å›¢é˜Ÿå…±äº«å’Œè®¨è®º
   - é¡¹ç›®æ–‡æ¡£å½’æ¡£

## âš™ï¸ å·¥å…·é…ç½®

### æ•°æ®åº“è¿æ¥å‚æ•°
```python
container_name = "corebank_postgres"  # å®¹å™¨åç§°
db_user = "corebank_user"            # æ•°æ®åº“ç”¨æˆ·
db_name = "corebank"                 # æ•°æ®åº“åç§°
```

### è‡ªå®šä¹‰é…ç½®
å¦‚éœ€ä¿®æ”¹è¿æ¥å‚æ•°ï¼Œç¼–è¾‘å·¥å…·æ–‡ä»¶ä¸­çš„`__init__`æ–¹æ³•ï¼š

```python
def __init__(self, container_name="your_container", db_user="your_user", db_name="your_db"):
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å®¹å™¨è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥å®¹å™¨çŠ¶æ€
   podman ps
   
   # æ£€æŸ¥æ•°æ®åº“è¿æ¥
   podman exec corebank_postgres psql -U corebank_user -d corebank -c "SELECT version();"
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿ç”¨æˆ·æœ‰è¶³å¤Ÿæƒé™
   podman exec corebank_postgres psql -U corebank_user -d corebank -c "\dt"
   ```

3. **è¾“å‡ºæ ¼å¼é—®é¢˜**
   - ç®€åŒ–ç‰ˆå·¥å…·ä½¿ç”¨PostgreSQLåŸç”Ÿå‘½ä»¤ï¼Œæ›´ç¨³å®š
   - å¦‚é‡åˆ°è§£æé—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨`simple_complete_analyzer.py`

## ğŸ“ˆ å·¥å…·çŠ¶æ€ç¡®è®¤

âœ… **æ•°æ®åº“åˆ†æå·¥å…·å®Œå…¨å¯ç”¨**

1. **è¿æ¥çŠ¶æ€**: âœ… PostgreSQL 16.8 è¿è¡Œæ­£å¸¸
2. **æƒé™éªŒè¯**: âœ… corebank_user å…·æœ‰å®Œæ•´è®¿é—®æƒé™  
3. **æ•°æ®å®Œæ•´æ€§**: âœ… æ‰€æœ‰11ä¸ªè¡¨ç»“æ„å®Œæ•´ï¼Œæ•°æ®ä¸€è‡´
4. **åŠŸèƒ½éªŒè¯**: âœ… æ‰€æœ‰åˆ†æåŠŸèƒ½æ­£å¸¸å·¥ä½œ

## ğŸ¯ æ€»ç»“

è¿™å¥—æ•°æ®åº“ç»“æ„æå–å·¥å…·ä¸ºCoreBanké¡¹ç›®æä¾›äº†å®Œæ•´çš„æ•°æ®åº“ç»“æ„åˆ†æèƒ½åŠ›ï¼Œæ”¯æŒï¼š

- **å®Œæ•´æ€§**ï¼šè¦†ç›–æ‰€æœ‰æ•°æ®åº“ç»“æ„å…ƒç´ 
- **å‡†ç¡®æ€§**ï¼šç›´æ¥ä»PostgreSQLç³»ç»Ÿè¡¨è·å–ä¿¡æ¯
- **å®ç”¨æ€§**ï¼šå¤šç§è¾“å‡ºæ ¼å¼æ»¡è¶³ä¸åŒéœ€æ±‚
- **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„ä¾¿äºæ‰©å±•

å»ºè®®å°†ç”Ÿæˆçš„ç»“æ„æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œç”¨äºè·Ÿè¸ªæ•°æ®åº“ç»“æ„çš„æ¼”è¿›å†å²ã€‚
